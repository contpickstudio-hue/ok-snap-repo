<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Redirecting...</title>
</head>
<body>
  <p>Redirecting to the app...</p>

  <script>
    // Deep link scheme for your Capacitor app
    const APP_SCHEME = "oksnap://auth/callback";

    // Extract OAuth hash parameters from URL fragment
    const hash = window.location.hash.substring(1);
    const params = new URLSearchParams(hash);

    const access_token = params.get("access_token");
    const refresh_token = params.get("refresh_token");
    const expires_in = params.get("expires_in");
    const token_type = params.get("token_type");

    // Build deep link URL with tokens
    const deepLinkUrl = `${APP_SCHEME}#access_token=${access_token}&refresh_token=${refresh_token}&expires_in=${expires_in}&token_type=${token_type}`;

    // Redirect into the native app
    window.location.href = deepLinkUrl;

    // Fallback for browsers (optional)
    setTimeout(() => {
      document.body.innerHTML = "<h3>Could not open the app. Please open OK-SNAP manually.</h3>";
    }, 2000);
  </script>
</body>
</html>
